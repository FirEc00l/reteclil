<!--
### 
### Responsabile: Perini,Andronio
###
-->

{% extends "base.html" %}
{% block title %}ReteCLIL - Search{% endblock %}

{% block content %}
	<title>Rete CLIL - Search</title>
	<style>
		.Abbrevia {
	    -o-text-overflow: ellipsis;   /* Opera */
	    text-overflow:    ellipsis;   /* IE, Safari (WebKit) */
	    overflow:hidden;              /* don't show excess chars */
	    white-space:nowrap;           /* force single line */
		}

		.modalfor {
	    	-o-text-overflow: white-space:nowrap;           /* force single line */
	    	text-overflow: white-space:nowrap;           /* force single line */
	    	word-wrap: break-word;
		}
	</style>
	<script>
		$(document).ready(function(){
			$('.modalfor').modal({
		      dismissible: true, // Modal can be dismissed by clicking outside of the modal
		      opacity: .5, // Opacity of modal background
		      inDuration: 300, // Transition in duration
		      outDuration: 200, // Transition out duration
		      startingTop: '4%', // Starting top style attribute
		      endingTop: '10%', // Ending top style attribute
		    });
			$('.ShowButton').modal();
			$("#search_key").bind("enterKey",function(e){
				a=$("#search_key").val(); // Prende il valore da search
				$(location).attr('href', '/search/'+a); // Lo mette nella URL
			});
			$("#search_key").keyup(function(e){ // "Quando premi enter si attiva l'evento enter [Non saprei come spiegarlo meglio..]"
				if(e.keyCode == 13){
				       $(this).trigger("enterKey");
				}
			});
			$('.btn-floating').each(function(){
		    	$(this).click(function(){
		        	$('modalfor'+$(this).attr('name')).modal("open");
			    });
			});
		});		     	
	</script>		<br>
		<br>
		<h2 align="center">Ricerca documenti</h2>
		<br>
		<div class="row"> <!-- Barra di ricerca -->
			<div class="input-field col s6 offset-m3">
				<i class="material-icons prefix">search</i>
				<input id="search_key" type="text" class="validate">
				<label for="icon_prefix">Cerca</label>
	    	</div>
	    </div>
		{% for item in dict_files %} <!-- Stampa dei modal -->
			<div id="modalfor{{item.name}}" class="modalfor modal" style=" z-index: 1003; display: none; opacity: .5; transform: scaleX(0.7); top: 154.742px; background-color: #e0e0e0;">
          		<div class="modal-content">
		            <h4 style="background-color: #e0e0e0 ">{{item.name}}</h4>
		            <hr>
		            {% if item.extension == "jpg" or item.extension == "jpeg" or item.extension == "png" or item.extension == "ico" %}
		            	<img src="/static/files/{{item.name}}">
		            {% else %}
		            	<p>{{item.description}}</p>
		            {% endif %}
		            <form> <!-- Bottone -->
		            <a href="/static/files/{{item.name}}" class="ShowButton btn-floating modal-trigger waves-effect waves-light blue right" download="{{item.name}}"><i class="material-icons">vertical_align_bottom</i></a>
		            </form>
		            <br>
          		</div>
          	</div>
          	<!-- Fine Modal -->
        {% endfor %}
		{% for item in dict_files %} <!-- Stampa delle carte -->
			<div class="row"> 
		       	<div class="col m4">
		       	{% if item.extension == "pdf" %}
			        <div class="card red lighten-1">
			    {% elif item.extension == "jpg" or item.extension == "jpeg" or item.extension == "png" or item.extension == "ico" %}
			        <div class="card blue lighten-3">
			    {% elif item.extension == "mov" or item.extension == "mp4" %}
			        <div class="card purple lighten-2">
			    {% elif item.extension == "mp3" or item.extension == "m4a" or item.extension == "wav"  %}
			        <div class="card indigo lighten-2">
			    {% elif item.extension == "zip" or item.extension == "rar" or item.extension == "7z"  %}
			        <div class="card amber lighten-2">
			    {% elif item.extension == "odp" or item.extension == "ppt" or item.extension == "pps"  %}
			        <div class="card orange">
			    {% elif item.extension == "ods" or item.extension == "xls" or item.extension == "xml"  %}
			        <div class="card green">
				{% endif %}
				        <form name="Carta" type="/POST" class="card-content">
				            <span class="Abbrevia card-title" id="{{item.name}}">{{item.name}}</span>
				            <a name="{{item.name}}" id="ShowButton{{item.name}}" class="ShowButton btn-floating modal-trigger waves-effect waves-light blue right" href="#modalfor{{item.name}}"><i class="material-icons">perm_media</i></a>
				            <p class="Abbrevia" id="{{item.description}}">{{item.description}}</p>
				        </form>
				    </div>
		     	</div>
		     	<!-- ### Prossima Carta ### -->
		{% endfor %}
		   	</div>
    	{% if error %}
			<div class="row">
				<div class="col s6 offset-m3">
					<div class="error" id="error">
						<blockquote> <h5>ERRORE</h5>La ricerca non ha ottenuto alcun risultato</blockquote>
					</div>
				</div>
			</div>
		{% endif %}
{% endblock %}